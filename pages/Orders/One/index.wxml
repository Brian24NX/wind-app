<!--pages/Orders/One/index.wxml-->
<wxs module="filters" src="../../../utils/format.wxs"></wxs>
<view class="searchResultContainers" wx:if="{{showSearch}}">
  <view class="searchResultContainer">
    <view class="resTitle">{{languageContent.title}}</view>
    <view class="resList others">
      <view class="oneRes">
        <image src="/assets/img/search/xianghao@2x.png" mode="aspectFit" class="resIcon"></image>
        <view class="resContent">{{detail.id}}</view>
      </view>
      <view class="oneRes">
        <image src="/assets/img/search/daxiao@2x.png" mode="aspectFit" class="resIcon"></image>
        <view class="resContent">{{detail.size}}{{detail.type}}</view>
      </view>
    </view>
  </view>
</view>

<view class="oneOrderContainer" wx:if="{{stepList.length}}">
  <view class="timeContainer">
    <view class="times timeTop">
      <view class="left">{{languageContent.language === 'en' ? filters.formatEnDate(stepList[stepList.length - 1].date, '-', 'short') : filters.formatCnDate(stepList[stepList.length - 1].date)}} {{stepList[stepList.length - 1].time}}</view>
      <view class="right">{{timeRemaining}} {{languageContent.tian}}</view>
    </view>
    <view class="times timeBottom">
      <view class="left">
        <text>{{timeRemaining < 1 ? languageContent.tingbo : languageContent.yuji }}</text>
      </view>
      <view class="right">{{languageContent.shengyu}}</view>
    </view>
  </view>
  <view class="stepContainers">
    <view class="stepContainer">
      <view class="stepLine">
        <view class="stopDto dtoLeft"></view>
        <view class="stopDto dtoRight"></view>
        <view class="activedLine" style="width: {{(stepCount / stepList.length) * 100 + '%;'}};"></view>
        <image class="zhuizong" style="left: {{(stepCount / stepList.length) * 100 + '%;'}}" src="/assets/img/search/zhuizong@2x.png"></image>
      </view>
    </view>
    <view class="stepBottom">
      <view>{{detail.portOfLoadingCountryName}} ({{detail.portOfLoadingCountryCode}})</view>
      <view>{{detail.portOfDischargeCountryName}} ({{detail.portOfDischargeCountryCode}})</view>
    </view>
  </view>
  <view class="stepLists">
    <view class="oneStep" wx:for="{{stepList}}" wx:key="index">
      <view class="leftLines">
        <view class="beingDtoBg" wx:if="{{item.stepStatus === 'being'}}"></view>
        <view class="leftLineDto {{item.stepStatus === 'past' ? 'pastDto' : item.stepStatus === 'being' ? 'beingDto' : ''}}"></view>
        <view class="leftLine {{item.stepStatus === 'past' ? 'past' : ''}}" wx:if="{{index !== stepList.length - 1}}"></view>
      </view>
      <view class="stepContent {{item.stepStatus === 'being' ? 'beingBg' : ''}}">
        <view class="stepSatus">{{languageContent.language === 'en' ? item.status.name : item.status.statusLabel}}</view>
        <view class="stepTime">{{languageContent.language === 'en' ? filters.formatEnDate(item.date, '-', 'short') : filters.formatCnDate(item.date)}} {{item.pointLocation.name}}, {{item.countryCode}}</view>
      </view>
    </view>
  </view>
  <view class="bottomContainer">
    <view class="downloadBtn" bindtap="reportToPDF">{{languageContent.export}}</view>
    <view class="toEmail" catchtap="sendReport">{{languageContent.toEmail}}</view>
  </view>
</view>
<view class="noStepOrderData" wx:if="{{!stepList.length && !isLoading}}">
  <image src="https://ycyy-db-01.obs.cn-east-3.myhuaweicloud.com/test/no.png"></image>
  <view>未找到或已经卸货或返回堆场</view>
</view>
<email path="{{path}}" wx:if="{{showEmail}}" bind:closeEmail="closeEmail" bind:sendEmails="sendEmails"></email>